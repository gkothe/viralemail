package com.gerador; 
import com.funcs.Utilitario; 
import java.util.Date; 
import javax.servlet.http.HttpServletRequest; 
import javax.servlet.http.HttpServletResponse; 
import org.json.simple.JSONObject; 
import java.sql.Connection; 
import java.text.SimpleDateFormat; 
import java.io.PrintWriter; 
import org.json.simple.JSONArray; 

public class Ajax_Usuario{ 

 public void carregaUnicoAjax(HttpServletRequest request, HttpServletResponse response, Connection conn ) throws Exception{  JSONObject retorno = new JSONObject();	PrintWriter out = response.getWriter();  String pk = request.getParameter("id_usuario") == null ? "" : request.getParameter("id_usuario");   	if (!Utilitario.isNumeric(pk)) { throw new Exception("Parâmetro inválido!"); } 	Usuario obj = new Usuario(conn);  	obj.setIdUsuario( Long.parseLong(pk) ); 	obj.lista(); 	if(obj.next()){retorno.put("cod_cidade", obj.getCodCidade() == null ? "" : obj.getCodCidade() );retorno.put("desc_nome", obj.getDescNome() == null ? "" : obj.getDescNome() );retorno.put("desc_telefone", obj.getDescTelefone() == null ? "" : obj.getDescTelefone() );retorno.put("desc_endereco", obj.getDescEndereco() == null ? "" : obj.getDescEndereco() );retorno.put("num_enderec", obj.getNumEnderec() == null ? "" : obj.getNumEnderec() );retorno.put("desc_complemento", obj.getDescComplemento() == null ? "" : obj.getDescComplemento() );retorno.put("desc_login", obj.getDescLogin() == null ? "" : obj.getDescLogin() );retorno.put("desc_senha", obj.getDescSenha() == null ? "" : obj.getDescSenha() );retorno.put("desc_mail", obj.getDescMail() == null ? "" : obj.getDescMail() );retorno.put("flag_ativo", obj.getFlagAtivo() == null ? "" : obj.getFlagAtivo() );retorno.put("date_lastajax", obj.getDateLastajax() == null ? 0 :new SimpleDateFormat("dd/MM/yyyy HH:mm").format(obj.getDateLastajax() ));retorno.put("num_cpf", obj.getNumCpf() == null ? "" : obj.getNumCpf() );retorno.put("desc_cep", obj.getDescCep() == null ? "" : obj.getDescCep() );retorno.put("flag_ativado", obj.getFlagAtivado() == null ? "" : obj.getFlagAtivado() );retorno.put("chave_ativacao", obj.getChaveAtivacao() == null ? "" : obj.getChaveAtivacao() );retorno.put("desc_novoemailvalidacao", obj.getDescNovoemailvalidacao() == null ? "" : obj.getDescNovoemailvalidacao() );retorno.put("chave_ativacao_novoemail", obj.getChaveAtivacaoNovoemail() == null ? "" : obj.getChaveAtivacaoNovoemail() ); 	} 	retorno.put("msg", ""); 	retorno.put("msgok", "ok"); 	out.print(retorno.toJSONString()); } public void SaveAjax(HttpServletRequest request, HttpServletResponse response, Connection conn ) throws Exception{  JSONObject retorno = new JSONObject();	PrintWriter out = response.getWriter();  String id_usuario = request.getParameter("id_usuario") == null ? "" : request.getParameter("id_usuario");   String cod_cidade = request.getParameter("cod_cidade") == null ? "" : request.getParameter("cod_cidade");   String desc_nome = request.getParameter("desc_nome") == null ? "" : request.getParameter("desc_nome");   String desc_telefone = request.getParameter("desc_telefone") == null ? "" : request.getParameter("desc_telefone");   String desc_endereco = request.getParameter("desc_endereco") == null ? "" : request.getParameter("desc_endereco");   String num_enderec = request.getParameter("num_enderec") == null ? "" : request.getParameter("num_enderec");   String desc_complemento = request.getParameter("desc_complemento") == null ? "" : request.getParameter("desc_complemento");   String desc_login = request.getParameter("desc_login") == null ? "" : request.getParameter("desc_login");   String desc_senha = request.getParameter("desc_senha") == null ? "" : request.getParameter("desc_senha");   String desc_mail = request.getParameter("desc_mail") == null ? "" : request.getParameter("desc_mail");   String flag_ativo = request.getParameter("flag_ativo") == null ? "" : request.getParameter("flag_ativo");   String date_lastajax = request.getParameter("date_lastajax") == null ? "" : request.getParameter("date_lastajax");   String num_cpf = request.getParameter("num_cpf") == null ? "" : request.getParameter("num_cpf");   String desc_cep = request.getParameter("desc_cep") == null ? "" : request.getParameter("desc_cep");   String flag_ativado = request.getParameter("flag_ativado") == null ? "" : request.getParameter("flag_ativado");   String chave_ativacao = request.getParameter("chave_ativacao") == null ? "" : request.getParameter("chave_ativacao");   String desc_novoemailvalidacao = request.getParameter("desc_novoemailvalidacao") == null ? "" : request.getParameter("desc_novoemailvalidacao");   String chave_ativacao_novoemail = request.getParameter("chave_ativacao_novoemail") == null ? "" : request.getParameter("chave_ativacao_novoemail");   	if (!Utilitario.isNumeric(id_usuario)) { throw new Exception("Parâmetro inválido!"); } 	if (!Utilitario.isNumeric(cod_cidade)) { throw new Exception("Parâmetro inválido!"); } if(desc_nome.equalsIgnoreCase("")){ throw new Exception("Campo desc_nome esta em branco!"); }  if(desc_telefone.equalsIgnoreCase("")){ throw new Exception("Campo desc_telefone esta em branco!"); }  if(desc_endereco.equalsIgnoreCase("")){ throw new Exception("Campo desc_endereco esta em branco!"); }  if(num_enderec.equalsIgnoreCase("")){ throw new Exception("Campo num_enderec esta em branco!"); }  if(desc_complemento.equalsIgnoreCase("")){ throw new Exception("Campo desc_complemento esta em branco!"); }  if(desc_login.equalsIgnoreCase("")){ throw new Exception("Campo desc_login esta em branco!"); }  if(desc_senha.equalsIgnoreCase("")){ throw new Exception("Campo desc_senha esta em branco!"); }  if(desc_mail.equalsIgnoreCase("")){ throw new Exception("Campo desc_mail esta em branco!"); }  if(flag_ativo.equalsIgnoreCase("")){ throw new Exception("Campo flag_ativo esta em branco!"); }  if(date_lastajax.equalsIgnoreCase("")){ throw new Exception("Campo date_lastajax esta em branco!"); }  if(num_cpf.equalsIgnoreCase("")){ throw new Exception("Campo num_cpf esta em branco!"); }  if(desc_cep.equalsIgnoreCase("")){ throw new Exception("Campo desc_cep esta em branco!"); }  if(flag_ativado.equalsIgnoreCase("")){ throw new Exception("Campo flag_ativado esta em branco!"); }  if(chave_ativacao.equalsIgnoreCase("")){ throw new Exception("Campo chave_ativacao esta em branco!"); }  if(desc_novoemailvalidacao.equalsIgnoreCase("")){ throw new Exception("Campo desc_novoemailvalidacao esta em branco!"); }  if(chave_ativacao_novoemail.equalsIgnoreCase("")){ throw new Exception("Campo chave_ativacao_novoemail esta em branco!"); }  	Usuario obj = new Usuario(conn);  	obj.setIdUsuario( Long.parseLong(id_usuario) ); 	obj.setCodCidade( Integer.parseInt(cod_cidade) ); 	obj.setDescNome( desc_nome ); 	obj.setDescTelefone( desc_telefone ); 	obj.setDescEndereco( desc_endereco ); 	obj.setNumEnderec( num_enderec ); 	obj.setDescComplemento( desc_complemento ); 	obj.setDescLogin( desc_login ); 	obj.setDescSenha( desc_senha ); 	obj.setDescMail( desc_mail ); 	obj.setFlagAtivo( flag_ativo ); 	obj.setDateLastajax(	Utilitario.getTimeStamp(new SimpleDateFormat("dd/MM/yyyy").parse(date_lastajax)) ); 	obj.setNumCpf( num_cpf ); 	obj.setDescCep( desc_cep ); 	obj.setFlagAtivado( flag_ativado ); 	obj.setChaveAtivacao( chave_ativacao ); 	obj.setDescNovoemailvalidacao( desc_novoemailvalidacao ); 	obj.setChaveAtivacaoNovoemail( chave_ativacao_novoemail ); 	obj.insert(); 	obj.update(); 	retorno.put("msg", ""); 	retorno.put("msgok", "ok"); 	out.print(retorno.toJSONString()); } public void ListaAjax(HttpServletRequest request, HttpServletResponse response, Connection conn ) throws Exception{  JSONObject retorno = new JSONObject();JSONObject objjson = new JSONObject();	PrintWriter out = response.getWriter(); JSONArray array = new JSONArray(); String id_usuario = request.getParameter("id_usuario") == null ? "" : request.getParameter("id_usuario");   String cod_cidade = request.getParameter("cod_cidade") == null ? "" : request.getParameter("cod_cidade");   String desc_nome = request.getParameter("desc_nome") == null ? "" : request.getParameter("desc_nome");   String desc_telefone = request.getParameter("desc_telefone") == null ? "" : request.getParameter("desc_telefone");   String desc_endereco = request.getParameter("desc_endereco") == null ? "" : request.getParameter("desc_endereco");   String num_enderec = request.getParameter("num_enderec") == null ? "" : request.getParameter("num_enderec");   String desc_complemento = request.getParameter("desc_complemento") == null ? "" : request.getParameter("desc_complemento");   String desc_login = request.getParameter("desc_login") == null ? "" : request.getParameter("desc_login");   String desc_senha = request.getParameter("desc_senha") == null ? "" : request.getParameter("desc_senha");   String desc_mail = request.getParameter("desc_mail") == null ? "" : request.getParameter("desc_mail");   String flag_ativo = request.getParameter("flag_ativo") == null ? "" : request.getParameter("flag_ativo");   String date_lastajax = request.getParameter("date_lastajax") == null ? "" : request.getParameter("date_lastajax");   String num_cpf = request.getParameter("num_cpf") == null ? "" : request.getParameter("num_cpf");   String desc_cep = request.getParameter("desc_cep") == null ? "" : request.getParameter("desc_cep");   String flag_ativado = request.getParameter("flag_ativado") == null ? "" : request.getParameter("flag_ativado");   String chave_ativacao = request.getParameter("chave_ativacao") == null ? "" : request.getParameter("chave_ativacao");   String desc_novoemailvalidacao = request.getParameter("desc_novoemailvalidacao") == null ? "" : request.getParameter("desc_novoemailvalidacao");   String chave_ativacao_novoemail = request.getParameter("chave_ativacao_novoemail") == null ? "" : request.getParameter("chave_ativacao_novoemail");   	if (!Utilitario.isNumeric(id_usuario)) { throw new Exception("Parâmetro inválido!"); } 	if (!Utilitario.isNumeric(cod_cidade)) { throw new Exception("Parâmetro inválido!"); } if(desc_nome.equalsIgnoreCase("")){ throw new Exception("Campo desc_nome esta em branco!"); }  if(desc_telefone.equalsIgnoreCase("")){ throw new Exception("Campo desc_telefone esta em branco!"); }  if(desc_endereco.equalsIgnoreCase("")){ throw new Exception("Campo desc_endereco esta em branco!"); }  if(num_enderec.equalsIgnoreCase("")){ throw new Exception("Campo num_enderec esta em branco!"); }  if(desc_complemento.equalsIgnoreCase("")){ throw new Exception("Campo desc_complemento esta em branco!"); }  if(desc_login.equalsIgnoreCase("")){ throw new Exception("Campo desc_login esta em branco!"); }  if(desc_senha.equalsIgnoreCase("")){ throw new Exception("Campo desc_senha esta em branco!"); }  if(desc_mail.equalsIgnoreCase("")){ throw new Exception("Campo desc_mail esta em branco!"); }  if(flag_ativo.equalsIgnoreCase("")){ throw new Exception("Campo flag_ativo esta em branco!"); }  if(date_lastajax.equalsIgnoreCase("")){ throw new Exception("Campo date_lastajax esta em branco!"); }  if(num_cpf.equalsIgnoreCase("")){ throw new Exception("Campo num_cpf esta em branco!"); }  if(desc_cep.equalsIgnoreCase("")){ throw new Exception("Campo desc_cep esta em branco!"); }  if(flag_ativado.equalsIgnoreCase("")){ throw new Exception("Campo flag_ativado esta em branco!"); }  if(chave_ativacao.equalsIgnoreCase("")){ throw new Exception("Campo chave_ativacao esta em branco!"); }  if(desc_novoemailvalidacao.equalsIgnoreCase("")){ throw new Exception("Campo desc_novoemailvalidacao esta em branco!"); }  if(chave_ativacao_novoemail.equalsIgnoreCase("")){ throw new Exception("Campo chave_ativacao_novoemail esta em branco!"); }  	Usuario obj = new Usuario(conn);  if(!id_usuario.equalsIgnoreCase("")){   	obj.setIdUsuario( Long.parseLong(id_usuario) ); } if(!cod_cidade.equalsIgnoreCase("")){   	obj.setCodCidade( Integer.parseInt(cod_cidade) ); } if(!desc_nome.equalsIgnoreCase("")){   	obj.setDescNome( desc_nome ); } if(!desc_telefone.equalsIgnoreCase("")){   	obj.setDescTelefone( desc_telefone ); } if(!desc_endereco.equalsIgnoreCase("")){   	obj.setDescEndereco( desc_endereco ); } if(!num_enderec.equalsIgnoreCase("")){   	obj.setNumEnderec( num_enderec ); } if(!desc_complemento.equalsIgnoreCase("")){   	obj.setDescComplemento( desc_complemento ); } if(!desc_login.equalsIgnoreCase("")){   	obj.setDescLogin( desc_login ); } if(!desc_senha.equalsIgnoreCase("")){   	obj.setDescSenha( desc_senha ); } if(!desc_mail.equalsIgnoreCase("")){   	obj.setDescMail( desc_mail ); } if(!flag_ativo.equalsIgnoreCase("")){   	obj.setFlagAtivo( flag_ativo ); } if(!date_lastajax.equalsIgnoreCase("")){   	obj.setDateLastajax(	Utilitario.getTimeStamp(new SimpleDateFormat("dd/MM/yyyy").parse(date_lastajax)) ); } if(!num_cpf.equalsIgnoreCase("")){   	obj.setNumCpf( num_cpf ); } if(!desc_cep.equalsIgnoreCase("")){   	obj.setDescCep( desc_cep ); } if(!flag_ativado.equalsIgnoreCase("")){   	obj.setFlagAtivado( flag_ativado ); } if(!chave_ativacao.equalsIgnoreCase("")){   	obj.setChaveAtivacao( chave_ativacao ); } if(!desc_novoemailvalidacao.equalsIgnoreCase("")){   	obj.setDescNovoemailvalidacao( desc_novoemailvalidacao ); } if(!chave_ativacao_novoemail.equalsIgnoreCase("")){   	obj.setChaveAtivacaoNovoemail( chave_ativacao_novoemail ); } 	obj.lista(); 	while(obj.next()){objjson = new JSONObject();objjson.put("id_usuario", obj.getIdUsuario() == null ? 0 : obj.getIdUsuario() );objjson.put("cod_cidade", obj.getCodCidade() == null ? "" : obj.getCodCidade() );objjson.put("desc_nome", obj.getDescNome() == null ? "" : obj.getDescNome() );objjson.put("desc_telefone", obj.getDescTelefone() == null ? "" : obj.getDescTelefone() );objjson.put("desc_endereco", obj.getDescEndereco() == null ? "" : obj.getDescEndereco() );objjson.put("num_enderec", obj.getNumEnderec() == null ? "" : obj.getNumEnderec() );objjson.put("desc_complemento", obj.getDescComplemento() == null ? "" : obj.getDescComplemento() );objjson.put("desc_login", obj.getDescLogin() == null ? "" : obj.getDescLogin() );objjson.put("desc_senha", obj.getDescSenha() == null ? "" : obj.getDescSenha() );objjson.put("desc_mail", obj.getDescMail() == null ? "" : obj.getDescMail() );objjson.put("flag_ativo", obj.getFlagAtivo() == null ? "" : obj.getFlagAtivo() );objjson.put("date_lastajax", obj.getDateLastajax() == null ? 0 :new SimpleDateFormat("dd/MM/yyyy HH:mm").format(obj.getDateLastajax() ));objjson.put("num_cpf", obj.getNumCpf() == null ? "" : obj.getNumCpf() );objjson.put("desc_cep", obj.getDescCep() == null ? "" : obj.getDescCep() );objjson.put("flag_ativado", obj.getFlagAtivado() == null ? "" : obj.getFlagAtivado() );objjson.put("chave_ativacao", obj.getChaveAtivacao() == null ? "" : obj.getChaveAtivacao() );objjson.put("desc_novoemailvalidacao", obj.getDescNovoemailvalidacao() == null ? "" : obj.getDescNovoemailvalidacao() );objjson.put("chave_ativacao_novoemail", obj.getChaveAtivacaoNovoemail() == null ? "" : obj.getChaveAtivacaoNovoemail() );array.add(objjson); 	} 	retorno.put("lista", array); 	retorno.put("msg", ""); 	retorno.put("msgok", "ok"); 	out.print(retorno.toJSONString()); }
 
 }